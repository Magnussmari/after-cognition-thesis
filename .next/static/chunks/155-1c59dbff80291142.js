(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[155],{2155:function(e,t,r){Promise.resolve().then(r.bind(r,1439)),Promise.resolve().then(r.bind(r,5062))},1439:function(e,t,r){"use strict";r.d(t,{default:function(){return d}});var s=r(7437),a=r(2265),n=r(7648),l=r(9376),i=r(3139),o=r(8734);function d(e){var t;let{chapter:r,currentSection:d,userProgress:c=[]}=e,{user:x}=(0,o.a)(),h=(0,l.useRouter)(),m=(0,a.useRef)(null),[g,u]=(0,a.useState)(!0),[b,v]=(0,a.useState)(!1),[k,p]=(0,a.useState)(0),[y,j]=(0,a.useState)("");(0,a.useEffect)(()=>{x&&d&&(async()=>{let e=()=>{if(!m.current)return;let e=window.scrollY;p(Math.min(100,Math.max(0,e/(m.current.scrollHeight-window.innerHeight)*100)))};window.addEventListener("scroll",e);let t=setInterval(async()=>{if(k>0)try{await (0,i.RO)(x.id,d.id,k)}catch(e){console.error("Error updating progress:",e)}},5e3);return()=>{window.removeEventListener("scroll",e),clearInterval(t),k>0&&(0,i.RO)(x.id,d.id,k).catch(console.error)}})()},[x,d,k]),(0,a.useEffect)(()=>{let e=()=>{let e=window.getSelection();e&&e.toString().trim()?j(e.toString().trim()):j("")};return document.addEventListener("selectionchange",e),()=>document.removeEventListener("selectionchange",e)},[]);let f=async()=>{if(x&&d&&y){v(!0);try{var e,t,r,s;await (0,i.Ke)(x.id,d.id,y.substring(0,100),y,null===(r=window.getSelection())||void 0===r?void 0:null===(t=r.anchorNode)||void 0===t?void 0:null===(e=t.parentElement)||void 0===e?void 0:e.id),null===(s=window.getSelection())||void 0===s||s.removeAllRanges(),j("")}catch(e){console.error("Error creating bookmark:",e)}finally{v(!1)}}},w=e=>{h.push("/chapters/".concat(r.slug,"/").concat(e.slug))},N=e=>{let t=c.find(t=>t.section_id===e);return(null==t?void 0:t.progress_percentage)||0};return(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("aside",{className:"".concat(g?"w-64":"w-0"," transition-all duration-300 overflow-hidden bg-gray-50 dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700"),children:(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white uppercase tracking-wider mb-4",children:"Table of Contents"}),(0,s.jsx)("nav",{className:"space-y-1",children:null===(t=r.sections)||void 0===t?void 0:t.map(e=>{let t=(null==d?void 0:d.id)===e.id,r=N(e.id);return(0,s.jsx)("button",{onClick:()=>w(e),className:"w-full text-left px-3 py-2 text-sm rounded-md transition-colors relative ".concat(t?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400 font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"truncate pr-2",children:e.title}),r>0&&(0,s.jsx)("span",{className:"text-xs ".concat(100===r?"text-green-600 dark:text-green-400":"text-gray-400 dark:text-gray-600"),children:100===r?"âœ“":"".concat(Math.round(r),"%")})]})},e.id)})})]})}),(0,s.jsxs)("main",{className:"flex-1 relative",children:[(0,s.jsx)("button",{onClick:()=>u(!g),className:"absolute top-4 left-4 z-10 p-2 rounded-md bg-white dark:bg-gray-800 shadow-md hover:shadow-lg transition-shadow","aria-label":"Toggle sidebar",children:(0,s.jsx)("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g?(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"}):(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})}),(0,s.jsx)("div",{className:"fixed top-16 left-0 right-0 h-1 bg-gray-200 dark:bg-gray-700 z-20",children:(0,s.jsx)("div",{className:"h-full bg-blue-600 dark:bg-blue-400 transition-all duration-300",style:{width:"".concat(k,"%")}})}),(0,s.jsxs)("article",{ref:m,className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[(0,s.jsxs)("header",{className:"mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400 mb-4",children:[(0,s.jsx)(n.default,{href:"/chapters",className:"hover:text-gray-700 dark:hover:text-gray-300",children:"Chapters"}),(0,s.jsx)("span",{children:"/"}),(0,s.jsx)("span",{children:r.title})]}),(0,s.jsx)("h1",{className:"text-3xl sm:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:r.title}),r.description&&(0,s.jsx)("p",{className:"text-lg text-gray-600 dark:text-gray-300",children:r.description})]}),d?(0,s.jsxs)("div",{className:"prose prose-lg dark:prose-invert max-w-none",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-6",children:d.title}),(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:d.content},className:"thesis-content"}),(0,s.jsx)("nav",{className:"mt-12 pt-8 border-t border-gray-200 dark:border-gray-700",children:(0,s.jsx)("div",{className:"flex justify-between",children:r.sections&&(0,s.jsxs)(s.Fragment,{children:[d.order_index>0&&(0,s.jsxs)("button",{onClick:()=>{w(r.sections[d.order_index-1])},className:"flex items-center text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300",children:[(0,s.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous"]}),d.order_index<r.sections.length-1&&(0,s.jsxs)("button",{onClick:()=>{w(r.sections[d.order_index+1])},className:"flex items-center text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 ml-auto",children:["Next",(0,s.jsx)("svg",{className:"w-5 h-5 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})})})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Select a section from the table of contents to begin reading."}),r.sections&&r.sections.length>0&&(0,s.jsx)("div",{className:"grid gap-4",children:r.sections.map(e=>{let t=N(e.id);return(0,s.jsx)("button",{onClick:()=>w(e),className:"text-left p-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-blue-500 dark:hover:border-blue-400 transition-colors",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:e.title}),e.reading_time_minutes&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[e.reading_time_minutes," min read"]})]}),t>0&&(0,s.jsx)("span",{className:"text-sm ".concat(100===t?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"),children:100===t?"Completed":"".concat(Math.round(t),"%")})]})},e.id)})})]})]}),y&&x&&(0,s.jsxs)("div",{className:"fixed bottom-4 right-4 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 max-w-sm",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:"Create bookmark from selection?"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:f,disabled:b,className:"px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:b?"Creating...":"Bookmark"}),(0,s.jsx)("button",{onClick:()=>{var e;null===(e=window.getSelection())||void 0===e||e.removeAllRanges(),j("")},className:"px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 text-sm",children:"Cancel"})]})]})]})]})}}}]);